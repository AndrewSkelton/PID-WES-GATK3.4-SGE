#!/bin/bash
#$ -cwd -V
#$ -pe smp 1
#$ -l h_vmem=2G
#$ -e ~/log
#$ -o ~/log

source ~/.bash_profile

#-------------------------------------------------------------------------------------------#
#  Author      : Andrew J Skelton                                                           |
#  Language    : Bash                                                                       |
#  Study       : Exome Project                                                              |
#  Data Owner  : Newcastle University - Prof. Sophie Hambleton                              |
#  Description : Job Submission Script - Fastqc                                             |
#-------------------------------------------------------------------------------------------#

# $1 - Sample ID
# $2 - Output Path

##'Add Fastqc Module
##'-----------------------------------------------------------------------------------------#
module add apps/fastqc/0.11.2
##'-----------------------------------------------------------------------------------------#

##'Add to Log
##'-----------------------------------------------------------------------------------------#
echo '' >> $2/$1'.log'
echo '##################################################' >> $2/$1'.log'
echo 'Copying Trimmed Fastqc Files to Local Scratch Space' >> $2/$1'.log'
##'-----------------------------------------------------------------------------------------#

##'Copy Files to Node
##'-----------------------------------------------------------------------------------------#
cp $2/*.gz $TMPDIR
##'-----------------------------------------------------------------------------------------#

##'Add to Log
##'-----------------------------------------------------------------------------------------#
echo 'Fastqc Started: '$(date) >> $2/$1'.log'
echo `ls $TMPDIR` >> $2/$1'.log'
##'-----------------------------------------------------------------------------------------#

##'Run Fastqc
##'-----------------------------------------------------------------------------------------#
fastqc $TMPDIR/*.gz -o $2/fastqc
##'-----------------------------------------------------------------------------------------#

##'Add to Log
##'-----------------------------------------------------------------------------------------#
echo 'Fastqc Complete: '$(date) >> $2/$1'.log'
echo '##################################################' >> $2/$1'.log'
echo '' >> $2/$1'.log'
##'-----------------------------------------------------------------------------------------#
